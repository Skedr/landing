---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import GalleryVue from "./Gallery.vue";

interface Props {
  folder: string;
}
const { folder } = Astro.props;

const allImages = await Astro.glob<{ default: ImageMetadata }>(
  `../assets/posts/*/**`
);

const images = allImages.filter(({ default: { src } }) => src.includes(folder));

const customCredits = images.map(({ default: { src } }) =>
  src.split("-").pop()?.split(".")[0].replaceAll("_", " ")
);
const uniquePhotographers = new Set(customCredits);
const credits = `Image credits: ${Array.from(uniquePhotographers).join(", ")}`;

const altText = (name: string) => {
  const photo = name.split(".")[0].split("/").pop();

  if (photo) {
    return photo.replaceAll("_", " ").replace("-", " - ");
  } else {
    return name;
  }
};
---

<GalleryVue client:only="vue" images={images} credits={credits} />
